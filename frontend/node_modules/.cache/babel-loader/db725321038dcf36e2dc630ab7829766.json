{"ast":null,"code":"var _jsxFileName = \"C:\\\\negocios\\\\eagro\\\\p1\\\\frontend\\\\src\\\\components\\\\participant\\\\index.tsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useRef, useState } from \"react\";\nimport { MdVideocam, MdVideocamOff, MdMic, MdMicOff } from \"react-icons/md\";\nimport { ToolBar, Video, VideoTurnedOff, VideoCard, FirstNameChar, IconButton } from \"./styled\";\nimport { useTrack } from \"../../hooks/useTrack\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ParticipantCard = ({\n  participant,\n  isLocal,\n  width,\n  height\n}) => {\n  _s();\n\n  const [opacity, setOpacity] = useState(\"0\");\n  const {\n    audioTracks,\n    isRemoteCameraOn,\n    isRemoteMicOn,\n    videoTracks\n  } = useTrack(participant);\n  const [isRemoteCameraDisabledFromLocal, setIsRemoteCameraDisabledFromLocal] = useState(false);\n  const [isRemoteMicDisabledFromLocal, setIsRemoteMicDisabledFromLocal] = useState(false);\n  const videoRef = useRef(null);\n  const audioRef = useRef(null);\n\n  const showBar = () => {\n    if (!isLocal) setOpacity(\"0.7\");\n  };\n\n  const hideBar = () => {\n    if (!isLocal) setOpacity(\"0\");\n  };\n\n  const toggleLocalCamera = () => {\n    if (isRemoteCameraOn) {\n      videoTracks[0].mediaStreamTrack.enabled = isRemoteCameraDisabledFromLocal;\n      setIsRemoteCameraDisabledFromLocal(!isRemoteCameraDisabledFromLocal);\n    }\n  };\n\n  const toggleLocalMic = () => {\n    if (isRemoteMicOn) {\n      console.log(!isMicOn());\n      setIsRemoteMicDisabledFromLocal(isMicOn());\n    }\n  };\n\n  const isMicOn = () => isRemoteMicOn && !isRemoteMicDisabledFromLocal;\n\n  const isCameraOn = () => isRemoteCameraOn && !isRemoteCameraDisabledFromLocal;\n\n  useEffect(() => {\n    const videoTrack = videoTracks[0];\n    const audioTrack = audioTracks[0];\n\n    if ((videoTrack === null || videoTrack === void 0 ? void 0 : videoTrack.attach) && videoRef.current) {\n      videoTrack.attach(videoRef.current);\n    }\n\n    if ((audioTrack === null || audioTrack === void 0 ? void 0 : audioTrack.attach) && audioRef.current) {\n      audioTrack.attach(audioRef.current);\n    }\n\n    return () => {\n      if ((videoTrack === null || videoTrack === void 0 ? void 0 : videoTrack.detach) && (audioTrack === null || audioTrack === void 0 ? void 0 : audioTrack.detach)) {\n        videoTrack === null || videoTrack === void 0 ? void 0 : videoTrack.detach();\n        audioTrack === null || audioTrack === void 0 ? void 0 : audioTrack.detach();\n      }\n    };\n  }, [videoTracks, audioTracks]);\n  return /*#__PURE__*/_jsxDEV(VideoCard, {\n    width: width,\n    height: height,\n    onMouseOut: hideBar,\n    onMouseOver: showBar,\n    children: [!isLocal && /*#__PURE__*/_jsxDEV(ToolBar, {\n      top: true,\n      opacity: opacity,\n      children: [/*#__PURE__*/_jsxDEV(FirstNameChar, {\n        children: participant.identity.charAt(0).toUpperCase()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: participant.identity.toUpperCase()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this), isRemoteCameraOn ? /*#__PURE__*/_jsxDEV(Video, {\n      ref: videoRef,\n      autoPlay: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(VideoTurnedOff, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: audioRef,\n      autoPlay: true,\n      muted: isRemoteMicDisabledFromLocal\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), !isLocal && /*#__PURE__*/_jsxDEV(ToolBar, {\n      opacity: opacity,\n      justifyCenter: true,\n      children: [/*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: toggleLocalMic,\n        isActive: isMicOn(),\n        children: isMicOn() ? /*#__PURE__*/_jsxDEV(MdMic, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 26\n        }, this) : /*#__PURE__*/_jsxDEV(MdMicOff, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 38\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: toggleLocalCamera,\n        isActive: isCameraOn(),\n        children: isCameraOn() ? /*#__PURE__*/_jsxDEV(MdVideocam, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 29\n        }, this) : /*#__PURE__*/_jsxDEV(MdVideocamOff, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 46\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ParticipantCard, \"+n7rtIzpx07L0BoFIdDAPf5N+/4=\", false, function () {\n  return [useTrack];\n});\n\n_c = ParticipantCard;\nexport default ParticipantCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"ParticipantCard\");","map":{"version":3,"sources":["C:/negocios/eagro/p1/frontend/src/components/participant/index.tsx"],"names":["useEffect","useRef","useState","MdVideocam","MdVideocamOff","MdMic","MdMicOff","ToolBar","Video","VideoTurnedOff","VideoCard","FirstNameChar","IconButton","useTrack","ParticipantCard","participant","isLocal","width","height","opacity","setOpacity","audioTracks","isRemoteCameraOn","isRemoteMicOn","videoTracks","isRemoteCameraDisabledFromLocal","setIsRemoteCameraDisabledFromLocal","isRemoteMicDisabledFromLocal","setIsRemoteMicDisabledFromLocal","videoRef","audioRef","showBar","hideBar","toggleLocalCamera","mediaStreamTrack","enabled","toggleLocalMic","console","log","isMicOn","isCameraOn","videoTrack","audioTrack","attach","current","detach","identity","charAt","toUpperCase"],"mappings":"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","sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport { MdVideocam, MdVideocamOff, MdMic, MdMicOff } from \"react-icons/md\";\n\nimport {\n  ToolBar,\n  Video,\n  VideoTurnedOff,\n  VideoCard,\n  FirstNameChar,\n  IconButton,\n} from \"./styled\";\nimport { IProps } from \"./types\";\nimport { useTrack } from \"../../hooks/useTrack\";\n\nconst ParticipantCard = ({ participant, isLocal, width, height }: IProps) => {\n  const [opacity, setOpacity] = useState(\"0\");\n  const {\n    audioTracks,\n    isRemoteCameraOn,\n    isRemoteMicOn,\n    videoTracks,\n  } = useTrack(participant);\n\n  const [\n    isRemoteCameraDisabledFromLocal,\n    setIsRemoteCameraDisabledFromLocal,\n  ] = useState(false);\n  const [\n    isRemoteMicDisabledFromLocal,\n    setIsRemoteMicDisabledFromLocal,\n  ] = useState(false);\n\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n\n  const showBar = () => {\n    if (!isLocal) setOpacity(\"0.7\");\n  };\n\n  const hideBar = () => {\n    if (!isLocal) setOpacity(\"0\");\n  };\n\n  const toggleLocalCamera = () => {\n    if (isRemoteCameraOn) {\n      videoTracks[0].mediaStreamTrack.enabled = isRemoteCameraDisabledFromLocal;\n      setIsRemoteCameraDisabledFromLocal(!isRemoteCameraDisabledFromLocal);\n    }\n  };\n\n  const toggleLocalMic = () => {\n    if (isRemoteMicOn) {\n      console.log(!isMicOn());\n      setIsRemoteMicDisabledFromLocal(isMicOn());\n    }\n  };\n\n  const isMicOn = () => isRemoteMicOn && !isRemoteMicDisabledFromLocal;\n  const isCameraOn = () => isRemoteCameraOn && !isRemoteCameraDisabledFromLocal;\n\n  useEffect(() => {\n    const videoTrack = videoTracks[0];\n    const audioTrack = audioTracks[0];\n    if (videoTrack?.attach && videoRef.current) {\n      videoTrack.attach(videoRef.current);\n    }\n\n    if (audioTrack?.attach && audioRef.current) {\n      audioTrack.attach(audioRef.current);\n    }\n\n    return () => {\n      if (videoTrack?.detach && audioTrack?.detach) {\n        videoTrack?.detach();\n        audioTrack?.detach();\n      }\n    };\n  }, [videoTracks, audioTracks]);\n\n  return (\n    <VideoCard\n      width={width}\n      height={height}\n      onMouseOut={hideBar}\n      onMouseOver={showBar}\n    >\n      {!isLocal && (\n        <ToolBar top opacity={opacity}>\n          <FirstNameChar>\n            {participant.identity.charAt(0).toUpperCase()}\n          </FirstNameChar>\n          <span>{participant.identity.toUpperCase()}</span>\n        </ToolBar>\n      )}\n      {isRemoteCameraOn ? (\n        <Video ref={videoRef} autoPlay />\n      ) : (\n        <VideoTurnedOff />\n      )}\n      <audio ref={audioRef} autoPlay muted={isRemoteMicDisabledFromLocal} />\n      {!isLocal && (\n        <ToolBar opacity={opacity} justifyCenter>\n          <IconButton onClick={toggleLocalMic} isActive={isMicOn()}>\n            {isMicOn() ? <MdMic /> : <MdMicOff />}\n          </IconButton>\n          <IconButton onClick={toggleLocalCamera} isActive={isCameraOn()}>\n            {isCameraOn() ? <MdVideocam /> : <MdVideocamOff />}\n          </IconButton>\n        </ToolBar>\n      )}\n    </VideoCard>\n  );\n};\nexport default ParticipantCard;\n"]},"metadata":{},"sourceType":"module"}